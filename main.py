import csv
import os

from dotenv import load_dotenv
from netmiko import ConnectHandler

load_dotenv()
FIREWALL_HOST = os.environ.get("FIREWALL_HOST")
USERNAME = os.environ.get("USERNAME")
PASSWORD = os.environ.get("PASSWORD")

FIREWALL = {
    "device_type": "paloalto_panos",
    "host": FIREWALL_HOST,
    "username": USERNAME,
    "password": PASSWORD
}

CSV_DIR="input/"
FILENAME="vulnerability-protection.csv"


def csv_to_dict(file):
    """Consumes the CSV file generated from Palo Alto Vulnerability Exception List and returns a list of dictionaries

    Args:
        file (str): Location and and name of the file

    Returns:
        data (list): CSV converted to list of dictionary
    """
    with open(file, mode="r", encoding='utf-8-sig') as f:
        csv_reader = csv.DictReader(f)
        data = list(csv_reader)
    return data


if __name__ == "__main__":

    data = csv_to_dict(CSV_DIR + FILENAME)

    for x in data:
        print(x['ID'])

    # connection = ConnectHandler(**FIREWALL)
    # output = connection.send_command("show system info", expect_string=r">")
    # connection.disconnect()

    # print(output)
